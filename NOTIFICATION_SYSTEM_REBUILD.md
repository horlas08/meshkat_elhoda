# ๐ ุฅุนุงุฏุฉ ุจูุงุก ูุธุงู ุงูุฅุดุนุงุฑุงุช - ุฏููู ุดุงูู

## ๐ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ

ูุงู ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุฏูู (`prayer_notification_services.dart`) ูุนุชูุฏ ุนูู:
- โ `WorkManager` - ูุณุจุจ ูุดุงูู ูู ุงูุฎูููุฉ
- โ `Isolates` - ูุนูุฏ ูุบูุฑ ููุซูู
- โ ููุฏ ููุฑุฑ ููุนูุฏ (1749 ุณุทุฑ!)

**ุงููุชูุฌุฉ:**
- ุฅุดุนุงุฑุงุช "ุฐูุฑูู ุจุงููู" ูุง ุชุนูู ุนูุฏูุง ุชููู ุงูุดุงุดุฉ ูุบููุฉ
- ุชุนุงุฑุถ ุจูู ุงูุฅุดุนุงุฑุงุช ุงููุฎุชููุฉ
- ุตุนูุจุฉ ูู ุงูุตูุงูุฉ ูุงูุงุฎุชุจุงุฑ

---

## โ ุงูุญู ุงูุฌุฏูุฏ

ุชู ุฅูุดุงุก `prayer_notification_service_new.dart` ุจููุณ ุฃุณููุจ `collective_khatma_notification_service.dart` ุงูุฐู ูุนูู ุจุดูู ููุซูู:

### ุงููููุฒุงุช:
1. โ **ุจุฏูู WorkManager ุฃู Isolates** - ูุนุชูุฏ ููุท ุนูู `AwesomeNotifications`
2. โ **ููุฏ ูุจุณุท ููุธูู** - ุฃูู ูู 700 ุณุทุฑ
3. โ **ููุซูู** - ููุณ ุงูุทุฑููุฉ ุงูุชู ุชุนูู ูู ุฅุดุนุงุฑุงุช ุงูุฎุชูุฉ ุงูุฌูุงุนูุฉ
4. โ **ุณูู ุงูุงุฎุชุจุงุฑ** - ุฎูุงุฑ "ูู ุฏูููุฉ" ูู Debug Mode
5. โ **ูุง ุชุนุงุฑุถ** - ูู ููุน ุฅุดุนุงุฑ ูู ูุทุงู IDs ูููุตู

---

## ๐ฏ ุฃููุงุน ุงูุฅุดุนุงุฑุงุช

### 1. **ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ** (IDs: 1-100)
- **ุงูุชูุจูู ูุจู ุงูุฃุฐุงู ุจู 5 ุฏูุงุฆู** (ูุฌุงูู)
  - Channel: `reminder_channel`
  - ูุธูุฑ ูุจู 5 ุฏูุงุฆู ูู ูู ุตูุงุฉ
  - ูุน ุตูุช ูุฅูุชุฒุงุฒ
  
- **ุชุดุบูู ุงูุฃุฐุงู** (ูุฏููุน)
  - ูุณุชุฎุฏู `AthanAudioService` (Native Code)
  - ูุนูู ุญุชู ุนูุฏูุง ุชููู ุงูุดุงุดุฉ ูุบููุฉ
  - ุนุจุฑ `AlarmManager` ุงูุฃุตูู

### 2. **ุฐูุฑูู ุจุงููู** (IDs: 5000-5099)
- Channel: `zikr_channel`
- ุฎูุงุฑุงุช ุงููุชุฑุฉ ุงูุฒูููุฉ:
  - **1 ุฏูููุฉ** (Debug Mode ููุท - ููุงุฎุชุจุงุฑ)
  - 30 ุฏูููุฉ
  - 60 ุฏูููุฉ
  - 120 ุฏูููุฉ
  - 240 ุฏูููุฉ
- ูุฌุฏูู 24 ุฅุดุนุงุฑ ูุชุบุทูุฉ ููู ูุงูู
- ูุญุชุฑู ูุถุน ุงูุฎุดูุน

### 3. **ุฃุฐูุงุฑ ุงูุตุจุงุญ ูุงููุณุงุก** (IDs: 6000-6001)
- Channel: `azkar_sabah_masa_channel`
- 6000: ุฃุฐูุงุฑ ุงูุตุจุงุญ (6:00 ุตุจุงุญุงู)
- 6001: ุฃุฐูุงุฑ ุงููุณุงุก (6:00 ูุณุงุกู)

### 4. **ูุถุน ุงูุฎุดูุน**
- ูููุนูู ุชููุงุฆูุงู ุจุนุฏ ูู ุฃุฐุงู ููุฏุฉ 30 ุฏูููุฉ
- ูููุน ุฌููุน ุงูุฅุดุนุงุฑุงุช (ูุง ุนุฏุง ุงูุตูุงุฉ)
- ููุฏุงุฑ ุนุจุฑ `KhushooModeService`

---

## ๐ง ุฎุทูุงุช ุงูุงุณุชุจุฏุงู

### ุงูุฎุทูุฉ 1: ุงููุณุฎ ุงูุงุญุชูุงุทู
```bash
# ุงูุณุฎ ุงูููู ุงููุฏูู ููุณุฎุฉ ุงุญุชูุงุทูุฉ
cp lib/core/services/prayer_notification_services.dart lib/core/services/prayer_notification_services.dart.backup
```

### ุงูุฎุทูุฉ 2: ุงุณุชุจุฏุงู ุงูููู
```bash
# ุงุญุฐู ุงูููู ุงููุฏูู
rm lib/core/services/prayer_notification_services.dart

# ุฃุนุฏ ุชุณููุฉ ุงูููู ุงูุฌุฏูุฏ
mv lib/core/services/prayer_notification_service_new.dart lib/core/services/prayer_notification_services.dart
```

### ุงูุฎุทูุฉ 3: ุชุญุฏูุซ ุงูุงุณุชูุฑุงุฏุงุช
ูุง ุญุงุฌุฉ ูุชุบููุฑ ุฃู ุดูุก! ุงูููู ุงูุฌุฏูุฏ ูุณุชุฎุฏู ููุณ ุงุณู ุงูููุงุณ `PrayerNotificationService`.

### ุงูุฎุทูุฉ 4: ุฅุฒุงูุฉ WorkManager (ุงุฎุชูุงุฑู)
ุฅุฐุง ูู ุชูู ุชุณุชุฎุฏู `WorkManager` ูู ุฃู ููุงู ุขุฎุฑ:

1. ุงูุชุญ `pubspec.yaml`
2. ุงุญุฐู ุงูุณุทุฑ: `workmanager: ^0.5.2` (ุฃู ุงูุฅุตุฏุงุฑ ุงููุณุชุฎุฏู)
3. ููุฐ: `flutter pub get`

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ 1: ุฅุดุนุงุฑุงุช "ุฐูุฑูู ุจุงููู" ูุน ุงูุดุงุดุฉ ุงููุบููุฉ

1. ุงูุชุญ ุงูุชุทุจูู ูู Debug Mode
2. ุงุฐูุจ ุฅูู ุงูุฅุนุฏุงุฏุงุช โ ุงูุฅุดุนุงุฑุงุช
3. ูุนูู "ุฐูุฑูู ุจุงููู"
4. ุงุฎุชุฑ "ุฏูููุฉ ูุงุญุฏุฉ (ุงุฎุชุจุงุฑ)"
5. **ุฃุบูู ุงูุดุงุดุฉ**
6. ุงูุชุธุฑ ุฏูููุฉ ูุงุญุฏุฉ
7. โ ูุฌุจ ุฃู ูุธูุฑ ุฅุดุนุงุฑ ุฐูุฑ ุญุชู ูุน ุงูุดุงุดุฉ ุงููุบููุฉ

### ุงุฎุชุจุงุฑ 2: ุงูุชูุจูู ูุจู ุงูุฃุฐุงู

1. ูุนูู "ุงูุชูุจูู ูุจู ุงูุฃุฐุงู"
2. ุงูุชุธุฑ ุญุชู ูุจู 5 ุฏูุงุฆู ูู ููุช ุงูุตูุงุฉ
3. โ ูุฌุจ ุฃู ูุธูุฑ ุฅุดุนุงุฑ "โณ ุงูุชุฑุจุช ุงูุตูุงุฉ"

### ุงุฎุชุจุงุฑ 3: ุงูุฃุฐุงู ูุน ุงูุดุงุดุฉ ุงููุบููุฉ

1. ูุนูู "ุงูุฃุฐุงู" (ูุชุทูุจ ุงุดุชุฑุงู Premium)
2. ุฃุบูู ุงูุดุงุดุฉ
3. ุงูุชุธุฑ ุญุชู ููุช ุงูุตูุงุฉ
4. โ ูุฌุจ ุฃู:
   - ุชูุถุงุก ุงูุดุงุดุฉ
   - ููุดุบู ุตูุช ุงูุฃุฐุงู
   - ูุธูุฑ ุฅุดุนุงุฑ ุนูู ุดุงุดุฉ ุงูููู

### ุงุฎุชุจุงุฑ 4: ุนุฏู ุงูุชุนุงุฑุถ

1. ูุนูู ุฌููุน ุงูุฅุดุนุงุฑุงุช:
   - โ ุงูุชูุจูู ูุจู ุงูุฃุฐุงู
   - โ ุงูุฃุฐุงู
   - โ ุฐูุฑูู ุจุงููู (ุฏูููุฉ ูุงุญุฏุฉ)
   - โ ุฃุฐูุงุฑ ุงูุตุจุงุญ ูุงููุณุงุก
2. ุฑุงูุจ ุงูุฅุดุนุงุฑุงุช ููุฏุฉ ุณุงุนุฉ
3. โ ูุฌุจ ุฃู ุชุนูู ุฌููุนูุง ุจุฏูู ุชุนุงุฑุถ

### ุงุฎุชุจุงุฑ 5: ูุถุน ุงูุฎุดูุน

1. ูุนูู "ูุถุน ุงูุฎุดูุน"
2. ูุนูู "ุฐูุฑูู ุจุงููู" (ุฏูููุฉ ูุงุญุฏุฉ)
3. ุงูุชุธุฑ ุญุชู ููุช ุงูุตูุงุฉ
4. ุจุนุฏ ุงูุชูุงุก ุงูุฃุฐุงู:
   - โ ูุง ูุฌุจ ุฃู ุชุธูุฑ ุฅุดุนุงุฑุงุช "ุฐูุฑูู ุจุงููู" ููุฏุฉ 30 ุฏูููุฉ
   - โ ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ ุงูุชุงููุฉ ุชุนูู ุจุดูู ุทุจูุนู

---

## ๐ ููุงุฑูุฉ ุจูู ุงููุธุงู ุงููุฏูู ูุงูุฌุฏูุฏ

| ุงูููุฒุฉ | ุงููุธุงู ุงููุฏูู | ุงููุธุงู ุงูุฌุฏูุฏ |
|--------|---------------|---------------|
| ุนุฏุฏ ุงูุฃุณุทุฑ | 1749 ุณุทุฑ | ~700 ุณุทุฑ |
| WorkManager | โ ูุณุชุฎุฏู | โ ูุง ูุณุชุฎุฏู |
| Isolates | โ ูุณุชุฎุฏู | โ ูุง ูุณุชุฎุฏู |
| ููุซูููุฉ ุงูุฅุดุนุงุฑุงุช | โ๏ธ ูุชูุณุทุฉ | โ ุนุงููุฉ |
| ุณูููุฉ ุงูุตูุงูุฉ | โ ุตุนุจุฉ | โ ุณููุฉ |
| ุงูุงุฎุชุจุงุฑ | โ ุตุนุจ | โ ุณูู (Debug Mode) |
| ุงูุชุนุงุฑุถ | โ๏ธ ูุญุชูู | โ ูุง ููุฌุฏ |
| ุงูุฃุฏุงุก | โ๏ธ ูุชูุณุท | โ ููุชุงุฒ |

---

## ๐ ุงููุฑููุงุช ุงูุชูููุฉ

### ุงููุธุงู ุงููุฏูู:
```dart
// ูุนูุฏ - ูุณุชุฎุฏู WorkManager ู Isolates
@pragma('vm:entry-point')
void callbackDispatcher() {
  Workmanager().executeTask((task, inputData) async {
    // ููุฏ ูุนูุฏ ูู isolate ูููุตู
    await _executeInIsolate(...);
  });
}
```

### ุงููุธุงู ุงูุฌุฏูุฏ:
```dart
// ุจุณูุท - ูุจุงุดุฑ ูุซู CollectiveKhatmaNotificationService
Future<void> scheduleZikrReminders({
  required int intervalMinutes,
  String language = 'ar',
}) async {
  // ุฌุฏููุฉ ูุจุงุดุฑุฉ ุนุจุฑ AwesomeNotifications
  for (int i = 0; i < 24; i++) {
    await AwesomeNotifications().createNotification(...);
  }
}
```

---

## ๐จ ุงูุชุญุณููุงุช ุงูุฅุถุงููุฉ

### 1. Debug Mode ููุงุฎุชุจุงุฑ
```dart
// ูู notifications.dart
if (kDebugMode)
  _buildIntervalChip(
    context,
    label: 'ุฏูููุฉ ูุงุญุฏุฉ (ุงุฎุชุจุงุฑ)',
    minutes: 1,
    isSelected: settings.zikrIntervalMinutes == 1,
  ),
```

### 2. ุงุญุชุฑุงู ูุถุน ุงูุฎุดูุน
```dart
// ูู scheduleZikrReminders
final isKhushoo = await KhushooModeService().isKhushooModeActive();
if (isKhushoo && scheduledTime.isBefore(now.add(const Duration(minutes: 30)))) {
  log('๐คซ ุชุฎุทู ุฌุฏููุฉ ุฐูุฑ ุจุณุจุจ ูุถุน ุงูุฎุดูุน');
  continue;
}
```

### 3. ูุทุงูุงุช IDs ูููุตูุฉ
```dart
// ูุง ุชุนุงุฑุถ ุจูู ุงูุฅุดุนุงุฑุงุช
- ุงูุตูุงุฉ: 1-100
- ุฐูุฑูู ุจุงููู: 5000-5099
- ุฃุฐูุงุฑ ุงูุตุจุงุญ ูุงููุณุงุก: 6000-6001
- ุงูุฎุชูุฉ ุงูุฌูุงุนูุฉ: 99999 + hash-based IDs
```

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: ุฅุดุนุงุฑุงุช "ุฐูุฑูู ุจุงููู" ูุง ุชุธูุฑ

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชูุนูู ุงูุฅุดุนุงุฑ ูู ุงูุฅุนุฏุงุฏุงุช
2. ุชุฃูุฏ ูู ุฃู ูุฏูู ุงุดุชุฑุงู Premium
3. ุชุฃูุฏ ูู ุฃู ูุถุน ุงูุฎุดูุน ุบูุฑ ููุนูู
4. ุฌุฑุจ ุฎูุงุฑ "ุฏูููุฉ ูุงุญุฏุฉ" ูู Debug Mode

### ุงููุดููุฉ: ุงูุฃุฐุงู ูุง ููุดุบู ุนูุฏูุง ุชููู ุงูุดุงุดุฉ ูุบููุฉ

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุฅููุงู "ุชุญุณูู ุงูุจุทุงุฑูุฉ" ููุชุทุจูู
2. ุชุฃูุฏ ูู ุชูุนูู "ุงูุชุดุบูู ุงูุชููุงุฆู" (Xiaomi, Huawei, Oppo)
3. ุฑุงุฌุน ููู `PRAYER_NOTIFICATIONS_IMPROVEMENTS.md`

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑุงุช ุชุชุนุงุฑุถ ูุน ุจุนุถูุง

**ุงูุญู:**
- ูุฐุง ูุง ูุฌุจ ุฃู ูุญุฏุซ ูู ุงููุธุงู ุงูุฌุฏูุฏ!
- ุฅุฐุง ุญุฏุซุ ุชุฃูุฏ ูู ุงุณุชุจุฏุงู ุงูููู ุงููุฏูู ุจุงููุงูู

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฃุฐุงู ูุนูู ุนุจุฑ Native Code ููุท**
   - `AthanAudioService` ูุณุชุฎุฏู `AlarmManager` ุงูุฃุตูู
   - ูุฐุง ุถุฑูุฑู ููุนูู ุนูุฏูุง ุชููู ุงูุดุงุดุฉ ูุบููุฉ

2. **ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงูุฃุฎุฑู ุนุจุฑ Flutter**
   - ุงูุชูุจูู ูุจู ุงูุฃุฐุงู
   - ุฐูุฑูู ุจุงููู
   - ุฃุฐูุงุฑ ุงูุตุจุงุญ ูุงููุณุงุก
   - ุฅุดุนุงุฑุงุช ุงูุฎุชูุฉ ุงูุฌูุงุนูุฉ

3. **Debug Mode ููุงุฎุชุจุงุฑ ููุท**
   - ุฎูุงุฑ "ุฏูููุฉ ูุงุญุฏุฉ" ูุง ูุธูุฑ ูู Release Mode
   - ุงุณุชุฎุฏูู ููุชุฃูุฏ ูู ุนูู ุงูุฅุดุนุงุฑุงุช

4. **ูุถุน ุงูุฎุดูุน ูุญุชุฑู ุฌููุน ุงูุฅุดุนุงุฑุงุช**
   - ูููุน ุฅุดุนุงุฑุงุช ุงูุฐูุฑ ูุงูุฃุฐูุงุฑ
   - ูุง ูููุน ุฅุดุนุงุฑุงุช ุงูุตูุงุฉ

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

ูุจู ุงููุดุฑุ ุชุฃูุฏ ูู:

- [ ] ุงุณุชุจุฏุงู ุงูููู ุงููุฏูู ุจุงูุฌุฏูุฏ
- [ ] ุงุฎุชุจุงุฑ ุฌููุน ุฃููุงุน ุงูุฅุดุนุงุฑุงุช
- [ ] ุงุฎุชุจุงุฑ ูุน ุงูุดุงุดุฉ ุงููุบููุฉ
- [ ] ุงุฎุชุจุงุฑ ูุถุน ุงูุฎุดูุน
- [ ] ุงุฎุชุจุงุฑ ุนุฏู ุงูุชุนุงุฑุถ
- [ ] ุฅุฒุงูุฉ `WorkManager` ูู `pubspec.yaml` (ุฅุฐุง ูู ููุณุชุฎุฏู)
- [ ] ูุฑุงุฌุนุฉ ุงูู logs ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

---

## ๐ ุงูุฎูุงุตุฉ

ุงููุธุงู ุงูุฌุฏูุฏ:
- โ **ุฃุจุณุท** - ุฃูู ูู ูุตู ุนุฏุฏ ุงูุฃุณุทุฑ
- โ **ุฃููุซู** - ููุณ ุทุฑููุฉ ุงูุฎุชูุฉ ุงูุฌูุงุนูุฉ
- โ **ุฃุณูู ูู ุงูุงุฎุชุจุงุฑ** - Debug Mode
- โ **ูุง ุชุนุงุฑุถ** - ูุทุงูุงุช IDs ูููุตูุฉ
- โ **ูุนูู ูุน ุงูุดุงุดุฉ ุงููุบููุฉ** - ุชู ุงุฎุชุจุงุฑู

**ุงููุชูุฌุฉ:** ูุธุงู ุฅุดุนุงุฑุงุช ููุซูู ูุณูู ุงูุตูุงูุฉ! ๐
