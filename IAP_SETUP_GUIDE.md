# ุฏููู ุฅุนุฏุงุฏ ูุธุงู ุงูุงุดุชุฑุงูุงุช (In-App Purchases)

ุชู ุชูููุฐ ูุธุงู ุงูุงุดุชุฑุงูุงุช ุฏุงุฎู ุงูุชุทุจูู ุจุงุณุชุฎุฏุงู `in_app_purchase` package. ูุฐุง ุงูุฏููู ูุดุฑุญ ุงูุฎุทูุงุช ุงููุทููุจุฉ ูุฅููุงู ุงูุฅุนุฏุงุฏ.

## โ ูุง ุชู ุฅูุฌุงุฒู ูู ุงูููุฏ

1. **ุฅูุดุงุก `InAppPurchaseService`**: ุฎุฏูุฉ ูุฑูุฒูุฉ ููุชุนุงูู ูุน ุนูููุงุช ุงูุดุฑุงุก
2. **ุชุญุฏูุซ `SubscriptionRepository`**: ุฅุถุงูุฉ ุฏูุงู ููุดุฑุงุก ูุงุณุชุนุงุฏุฉ ุงููุดุชุฑูุงุช
3. **ุชุญุฏูุซ `SubscriptionBloc`**: ูุนุงูุฌุฉ ุฃุญุฏุงุซ ุงูุดุฑุงุก ูุงูููุชุฌุงุช
4. **ุชููุฆุฉ ุงูุฎุฏูุฉ**: ุชู ุฅุถุงูุฉ ุงูุชููุฆุฉ ูู `main.dart`

## ๐ ูุนุฑูุงุช ุงูููุชุฌุงุช (Product IDs)

ุชู ุชุนุฑูู ุงูููุชุฌุงุช ุงูุชุงููุฉ ูู ุงูููุฏ:

- **ุงูุงุดุชุฑุงู ุงูุดูุฑู**: `monthly_subscription` - 2.99 ุฏููุงุฑ
- **ุงูุงุดุชุฑุงู ุงูุณููู**: `yearly_subscription` - 19.99 ุฏููุงุฑ

โ๏ธ **ููู ุฌุฏุงู**: ูุฌุจ ุฃู ุชุชุทุงุจู ูุฐู ุงููุนุฑูุงุช ูุน ุงููุนุฑูุงุช ุงูุชู ุณุชููู ุจุฅูุดุงุฆูุง ูู Google Play Console ู App Store Connect.

## ๐ง ุงูุฎุทูุงุช ุงููุทููุจุฉ ุฎุงุฑุฌ ุงูุชุทุจูู

### 1๏ธโฃ ุฅุนุฏุงุฏ Google Play Console (Android)

#### ุฃ. ุฅูุดุงุก ุงูุชุทุจูู ูุฑูุนู
1. ุณุฌู ุฏุฎูู ุฅูู [Google Play Console](https://play.google.com/console)
2. ุฃูุดุฆ ุชุทุจููุงู ุฌุฏูุฏุงู ุฃู ุงุณุชุฎุฏู ุชุทุจููุงู ููุฌูุฏุงู
3. ูู ุจุฑูุน ูุณุฎุฉ APK ุฃู AAB ุฅูู ุงููุณุงุฑ ุงูุฏุงุฎูู (Internal Testing) ุฃู Alpha/Beta

#### ุจ. ุฅุนุฏุงุฏ ุงูุงุดุชุฑุงูุงุช
1. ุงูุชูู ุฅูู **Monetize** > **Subscriptions**
2. ุงููุฑ ุนูู **Create subscription**
3. ุฃูุดุฆ ุงูุงุดุชุฑุงู ุงูุดูุฑู:
   - **Product ID**: `monthly_subscription` (ูุฌุจ ุฃู ูุทุงุจู ุงูููุฏ ุชูุงูุงู)
   - **Name**: "ุงุดุชุฑุงู ุดูุฑู" ุฃู "Monthly Subscription"
   - **Description**: ูุตู ุงูุงุดุชุฑุงู
   - **Base plan**: ุฃูุดุฆ ุฎุทุฉ ุฃุณุงุณูุฉ
     - **Billing period**: ุดูุฑ ูุงุญุฏ (1 month)
     - **Price**: 2.99 ุฏููุงุฑ
     - **Free trial**: ุงุฎุชูุงุฑู (ููููู ุฅุถุงูุฉ ูุชุฑุฉ ุชุฌุฑูุจูุฉ)
   - **Save and activate**

4. ุฃูุดุฆ ุงูุงุดุชุฑุงู ุงูุณููู:
   - **Product ID**: `yearly_subscription`
   - **Name**: "ุงุดุชุฑุงู ุณููู" ุฃู "Yearly Subscription"
   - **Description**: ูุตู ุงูุงุดุชุฑุงู
   - **Base plan**: ุฃูุดุฆ ุฎุทุฉ ุฃุณุงุณูุฉ
     - **Billing period**: ุณูุฉ ูุงุญุฏุฉ (1 year)
     - **Price**: 19.99 ุฏููุงุฑ
     - **Free trial**: ุงุฎุชูุงุฑู
   - **Save and activate**

#### ุฌ. ุฅุนุฏุงุฏ ุงูุญุณุงุจ ุงููุงูู
1. ุงูุชูู ุฅูู **Setup** > **Payments profile**
2. ุฃููู ูุนูููุงุช ุงูุญุณุงุจ ุงูุจููู ูุงุณุชูุงู ุงูุฃุฑุจุงุญ
3. ูู ุจุงูุชุญูู ูู ุงูุญุณุงุจ

#### ุฏ. ุงุฎุชุจุงุฑ ุงูุงุดุชุฑุงูุงุช
1. ุงูุชูู ุฅูู **Setup** > **License testing**
2. ุฃุถู ุญุณุงุจุงุช Gmail ููุงุฎุชุจุงุฑ
3. ูุฐู ุงูุญุณุงุจุงุช ุณุชุชููู ูู ุงูุดุฑุงุก ุจุฏูู ุฏูุน ูุนูู

### 2๏ธโฃ ุฅุนุฏุงุฏ App Store Connect (iOS)

#### ุฃ. ุฅูุดุงุก ุงูุชุทุจูู
1. ุณุฌู ุฏุฎูู ุฅูู [App Store Connect](https://appstoreconnect.apple.com)
2. ุงูุชูู ุฅูู **My Apps** > **+** > **New App**
3. ุงููุฃ ูุนูููุงุช ุงูุชุทุจูู ุงูุฃุณุงุณูุฉ

#### ุจ. ุฅุนุฏุงุฏ ุงูุงุดุชุฑุงูุงุช
1. ุงูุชุญ ุงูุชุทุจูู ูู App Store Connect
2. ุงูุชูู ุฅูู **Features** > **In-App Purchases**
3. ุงููุฑ ุนูู **+** ูุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ
4. ุงุฎุชุฑ **Auto-Renewable Subscription**

5. ุฃูุดุฆ ูุฌููุนุฉ ุงุดุชุฑุงูุงุช (Subscription Group):
   - **Reference Name**: "Premium Subscriptions"
   - ุงููุฑ ุนูู **Create**

6. ุฃูุดุฆ ุงูุงุดุชุฑุงู ุงูุดูุฑู:
   - **Product ID**: `monthly_subscription` (ูุฌุจ ุฃู ูุทุงุจู ุงูููุฏ)
   - **Reference Name**: "Monthly Subscription"
   - **Subscription Duration**: 1 Month
   - **Subscription Prices**: ุฃุถู ุงูุณุนุฑ 2.99 ุฏููุงุฑ ูุฌููุน ุงูุฏูู
   - **Localization**: ุฃุถู ุงูุงุณู ูุงููุตู ุจุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
   - **Review Information**: ุฃุถู ููุทุฉ ุดุงุดุฉ ุชูุถุญ ุงูููุฒุฉ
   - **Save**

7. ุฃูุดุฆ ุงูุงุดุชุฑุงู ุงูุณููู:
   - **Product ID**: `yearly_subscription`
   - **Reference Name**: "Yearly Subscription"
   - **Subscription Duration**: 1 Year
   - **Subscription Prices**: ุฃุถู ุงูุณุนุฑ 19.99 ุฏููุงุฑ
   - **Localization**: ุฃุถู ุงูุงุณู ูุงููุตู
   - **Save**

#### ุฌ. ุฅุนุฏุงุฏ ุงูุญุณุงุจ ุงููุงูู
1. ุงูุชูู ุฅูู **Agreements, Tax, and Banking**
2. ูู ุจูุจูู ุงุชูุงููุฉ **Paid Applications**
3. ุฃุถู ูุนูููุงุช ุงูุถุฑุงุฆุจ
4. ุฃุถู ูุนูููุงุช ุงูุญุณุงุจ ุงูุจููู

#### ุฏ. ุงุฎุชุจุงุฑ ุงูุงุดุชุฑุงูุงุช
1. ุงูุชูู ุฅูู **Users and Access** > **Sandbox Testers**
2. ุฃุถู ุญุณุงุจุงุช ุงุฎุชุจุงุฑ ุฌุฏูุฏุฉ
3. ุงุณุชุฎุฏู ูุฐู ุงูุญุณุงุจุงุช ููุงุฎุชุจุงุฑ ุนูู ุฃุฌูุฒุฉ ุญููููุฉ

### 3๏ธโฃ ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ ูู ุงูููุฏ

#### ุชุญุฏูุซ AndroidManifest.xml
ุชุฃูุฏ ูู ูุฌูุฏ ุงูุฃุฐููุงุช ุงูุชุงููุฉ:

```xml
<uses-permission android:name="com.android.vending.BILLING" />
```

#### ุชุญุฏูุซ Info.plist (iOS)
ูุง ุชูุฌุฏ ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ ูุทููุจุฉุ ููู ุชุฃูุฏ ูู ุฃู Bundle ID ูุทุงุจู ูุง ูู App Store Connect.

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ Android
1. ูู ุจุจูุงุก ุงูุชุทุจูู ูู ูุถุน Release
2. ูู ุจุชุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ ุงุฎุชุจุงุฑ ูู License Testing
3. ุฌุฑุจ ุดุฑุงุก ุงูุงุดุชุฑุงูุงุช - ูู ูุชู ุฎุตู ุฃููุงู ูุนููุฉ

### ุงุฎุชุจุงุฑ iOS
1. ูู ุจุจูุงุก ุงูุชุทุจูู ุนูู ุฌูุงุฒ ุญูููู (Simulator ูุง ูุฏุนู IAP)
2. ูู ุจุชุณุฌูู ุงูุฎุฑูุฌ ูู ุญุณุงุจ App Store ุงูุญูููู
3. ุนูุฏ ูุญุงููุฉ ุงูุดุฑุงุกุ ุงุณุชุฎุฏู ุญุณุงุจ Sandbox Tester
4. ูู ูุชู ุฎุตู ุฃููุงู ูุนููุฉ

## ๐ฑ ููููุฉ ุงุณุชุฎุฏุงู ุงููุธุงู ูู ุงูุชุทุจูู

### ุชุญููู ุงูููุชุฌุงุช
```dart
context.read<SubscriptionBloc>().add(LoadProductsEvent());
```

### ุดุฑุงุก ุงุดุชุฑุงู
```dart
context.read<SubscriptionBloc>().add(
  BuySubscriptionEvent(productDetails)
);
```

### ุงุณุชุนุงุฏุฉ ุงููุดุชุฑูุงุช
```dart
context.read<SubscriptionBloc>().add(RestorePurchasesEvent());
```

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชุญูู ูู ุงูุดุฑุงุก**: ุญุงููุงูุ ุงูุชุทุจูู ูููู ุงูุดุฑุงุก ูุจุงุดุฑุฉ. ูู ุจูุฆุฉ ุงูุฅูุชุงุฌุ ูููุตุญ ุจุงูุชุญูู ูู ุงูุดุฑุงุก ุนุจุฑ ุงูุฎุงุฏู (Server-side verification).

2. **ุญูุธ ุญุงูุฉ ุงูุงุดุชุฑุงู**: ูุฌุจ ุชุญุฏูุซ `SubscriptionLocalDataSource` ูุญูุธ ุญุงูุฉ ุงูุงุดุชุฑุงู ุจุนุฏ ุงูุดุฑุงุก ุงููุงุฌุญ.

3. **ุฅุดุนุงุฑุงุช ุงูุชุฌุฏูุฏ**: ููููู ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ูุจู ุงูุชูุงุก ุงูุงุดุชุฑุงู ุจุงุณุชุฎุฏุงู Firebase Cloud Messaging.

4. **ุงูุฅูุบุงุก**: ุงููุณุชุฎุฏููู ููุบูู ุงูุงุดุชุฑุงูุงุช ูู ุฅุนุฏุงุฏุงุช Google Play ุฃู App Storeุ ูููุณ ูู ุงูุชุทุจูู.

## ๐ ุงูุฃูุงู

ููุฅูุชุงุฌุ ูููุตุญ ุจุดุฏุฉ ุจุชูููุฐ:
1. **Server-side verification**: ุงูุชุญูู ูู ุตุญุฉ ุงูุฅูุตุงูุงุช ุนูู ุงูุฎุงุฏู
2. **Receipt validation**: ุงูุชุญูู ูู ุงูุฅูุตุงูุงุช ูุจู ููุญ ุงูููุฒุงุช
3. **Secure storage**: ุชุฎุฒูู ูุนูููุงุช ุงูุงุดุชุฑุงู ุจุดูู ุขูู

## ๐ ูุตุงุฏุฑ ุฅุถุงููุฉ

- [Google Play Billing Documentation](https://developer.android.com/google/play/billing)
- [Apple In-App Purchase Documentation](https://developer.apple.com/in-app-purchase/)
- [in_app_purchase Package](https://pub.dev/packages/in_app_purchase)

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

- [ ] ุฅูุดุงุก ุงูุงุดุชุฑุงูุงุช ูู Google Play Console
- [ ] ุฅูุดุงุก ุงูุงุดุชุฑุงูุงุช ูู App Store Connect
- [ ] ุฅุนุฏุงุฏ ุงูุญุณุงุจุงุช ุงููุงููุฉ ูู ููุง ุงูููุตุชูู
- [ ] ุฅุถุงูุฉ ุญุณุงุจุงุช ุงูุงุฎุชุจุงุฑ
- [ ] ุงุฎุชุจุงุฑ ุงูุดุฑุงุก ุนูู Android
- [ ] ุงุฎุชุจุงุฑ ุงูุดุฑุงุก ุนูู iOS
- [ ] ุชุญุฏูุซ `SubscriptionLocalDataSource` ูุญูุธ ุญุงูุฉ ุงูุงุดุชุฑุงู
- [ ] ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุฎุงุฏู (ุงุฎุชูุงุฑู ููู ููุตู ุจู)
- [ ] ุงุฎุชุจุงุฑ ุงุณุชุนุงุฏุฉ ุงููุดุชุฑูุงุช
- [ ] ุงุฎุชุจุงุฑ ุฅูุบุงุก ุงูุงุดุชุฑุงู
